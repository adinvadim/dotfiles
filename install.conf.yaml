- defaults:
    link:
      relink: true

- clean: ['~']

- create:
    - ~/.config
    - ~/.config/coc
    - ~/.agents/skills
    - ~/.codex/skills
    - ~/.claude/skills
    - ~/bin

- shell:
  # Make AGENTS.md / CLAUDE.md linking idempotent (backup if a regular file already exists).
  - sh -c 'if [ -e "$HOME/.codex/AGENTS.md" ] && [ ! -L "$HOME/.codex/AGENTS.md" ]; then mv "$HOME/.codex/AGENTS.md" "$HOME/.codex/AGENTS.md.bak.$(date +%Y%m%d%H%M%S)"; fi'
  - sh -c 'if [ -e "$HOME/.claude/CLAUDE.md" ] && [ ! -L "$HOME/.claude/CLAUDE.md" ]; then mv "$HOME/.claude/CLAUDE.md" "$HOME/.claude/CLAUDE.md.bak.$(date +%Y%m%d%H%M%S)"; fi'
  - sh -c 'if [ -e "$HOME/.codex/config.toml" ] && [ ! -L "$HOME/.codex/config.toml" ]; then mv "$HOME/.codex/config.toml" "$HOME/.codex/config.toml.bak.$(date +%Y%m%d%H%M%S)"; fi'

- link:
    ~/.tmux.conf: .tmux.conf
    ~/.gitconfig: .gitconfig
    ~/.gitmux.conf: .gitmux.conf
    ~/.nuxtrc: .nuxtrc
    ~/.ripgreprc: .ripgreprc
    ~/.zshrc: .zshrc
    ~/.config/nvim: nvim
    ~/bin/tat: bin/tat
    ~/bin/kill-by-port: bin/kill-by-port
    ~/bin/kitty-dark: bin/kitty-dark
    ~/bin/tmux-gh-pr: bin/tmux-gh-pr
    ~/bin/tmux-gh-pr-open: bin/tmux-gh-pr-open
    ~/bin/tmux-ai-status: bin/tmux-ai-status
    ~/bin/tmux-subscript: bin/tmux-subscript
    ~/bin/db: bin/db
    ~/bin/ohmydb: bin/ohmydb
    ~/bin/setup-firecrawl-mcp: bin/setup-firecrawl-mcp
    ~/bin/docs-list: bin/docs-list
    /opt/homebrew/share/zsh/site-functions/_db: bin/_db
    /opt/homebrew/share/zsh/site-functions/_ohmydb: bin/_ohmydb
    ~/.editorconfig: .editorconfig
    ~/.codex/AGENTS.md: AGENTS.md
    ~/.codex/config.toml: codex/config.toml
    ~/.claude/CLAUDE.md: CLAUDE.md
    ~/.config/kitty: kitty
    ~/.config/coc/ultisnips: ultisnips
    ~/safari-global.css: safari/global.css
    ~/.agents/skills/create-cli: agents/skills/create-cli
    ~/.codex/skills/create-cli: agents/skills/create-cli
    ~/.claude/skills/create-cli: agents/skills/create-cli
    ~/.agents/skills/code-simplifier: agents/skills/code-simplifier
    ~/.codex/skills/code-simplifier: agents/skills/code-simplifier
    ~/.claude/skills/code-simplifier: agents/skills/code-simplifier

- create:
    - ~/.vim/undo-history

- shell:
  - [git submodule update --init --recursive, Installing submodules]
  - sh -c '"$PWD/bin/setup-firecrawl-mcp"'
  - sh -c 'curl -fLo "${XDG_DATA_HOME:-$HOME/.local/share}"/nvim/site/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim'
  - sh -c 'if [ ! -d "$HOME/.oh-my-zsh" ]; then RUNZSH=no CHSH=no KEEP_ZSHRC=yes sh -c "$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"; fi'
  - sh -c 'if [ -f "$HOME/.zshrc.pre-oh-my-zsh" ]; then mv "$HOME/.zshrc.pre-oh-my-zsh" "$HOME/.zshrc"; fi'
  - sh -c 'if [ ! -d "$HOME/.tmux/plugins/tpm" ]; then mkdir -p "$HOME/.tmux/plugins" && git clone https://github.com/tmux-plugins/tpm "$HOME/.tmux/plugins/tpm"; fi'
